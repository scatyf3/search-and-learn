Performance Analysis for BEST_OF_N_TRANSFORMERS
==================================================

Configuration:
  - Model: meta-llama/Llama-3.2-3B-Instruct
  - Approach: best_of_n_transformers
  - LLM Backend: transformers
  - Batch size: 25
  - Number of samples (n): 4
  - GPUs Available: 1

Top 20 operations by CUDA time:
----------------------------------------
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total GFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                        model_inference         0.00%       0.000us         0.00%       0.000us       0.000us      184.097s       299.58%      184.097s      184.097s           0 B           0 B           0 B           0 B             1            --  
                                        model_inference        43.23%       79.842s        99.74%      184.220s      184.220s       0.000us         0.00%       61.496s       61.496s           0 B     -35.90 GB      15.53 MB    -146.85 GB             1            --  
                                           aten::matmul         2.35%        4.344s        10.80%       19.948s      51.628us       0.000us         0.00%       30.480s      78.889us           0 B           0 B      27.76 GB      -1.64 GB        386370            --  
                                           aten::linear         0.58%        1.067s         9.49%       17.535s      58.515us       0.000us         0.00%       29.258s      97.636us           0 B           0 B      12.99 GB           0 B        299665            --  
                                               aten::mm         3.73%        6.888s         5.10%        9.415s      31.417us       29.216s        47.54%       29.258s      97.636us           0 B           0 B      12.99 GB      12.99 GB        299665     63933.264  
                                            aten::copy_         1.73%        3.188s        18.15%       33.515s      67.856us       25.093s        40.83%       25.094s      50.806us           0 B           0 B           0 B           0 B        493906            --  
                                               aten::to         0.47%     863.315ms        20.38%       37.638s      75.034us       0.000us         0.00%       23.865s      47.576us      35.90 GB           0 B     173.44 GB      -6.79 MB        501614            --  
                                         aten::_to_copy         1.28%        2.366s        19.91%       36.774s      91.721us       0.000us         0.00%       23.865s      59.522us      35.90 GB           0 B     173.44 GB      -1.43 MB        400938            --  
std::enable_if<!(false), void>::type internal::gemvx...         0.00%       0.000us         0.00%       0.000us       0.000us       22.673s        36.90%       22.673s      75.917us           0 B           0 B           0 B           0 B        298656            --  
                       Memcpy DtoH (Device -> Pageable)         0.00%       0.000us         0.00%       0.000us       0.000us       22.360s        36.39%       22.360s       3.805ms           0 B           0 B           0 B           0 B          5877            --  
void magma_sgemmEx_kernel<float, __nv_bfloat16, __nv...         0.00%       0.000us         0.00%       0.000us       0.000us        6.445s        10.49%        6.445s      28.646ms           0 B           0 B           0 B           0 B           225            --  
                     aten::scaled_dot_product_attention         0.21%     380.196ms        12.52%       23.122s     542.884us       0.000us         0.00%        5.028s     118.042us           0 B           0 B       1.18 GB      -6.51 GB         42592            --  
               aten::_scaled_dot_product_attention_math         0.84%        1.546s        12.31%       22.736s     533.819us       0.000us         0.00%        5.027s     118.019us           0 B      -1.00 KB       7.51 GB    -702.08 GB         42592            --  
                                              aten::mul         3.00%        5.545s         4.50%        8.316s      17.392us        1.954s         3.18%        1.954s       4.086us       1.04 KB       1.04 KB     195.40 GB     195.40 GB        478185        53.900  
                                            aten::clone         0.20%     371.081ms         1.17%        2.159s      24.005us       0.000us         0.00%        1.224s      13.613us           0 B           0 B     370.45 GB           0 B         89924            --  
                                              aten::bmm         1.20%        2.210s         1.51%        2.783s      32.092us        1.214s         1.98%        1.215s      14.008us           0 B           0 B      14.77 GB      14.77 GB         86705      1703.747  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us        1.203s         1.96%        1.203s      14.126us           0 B           0 B           0 B           0 B         85152            --  
                                aten::repeat_interleave         0.34%     619.489ms         2.17%        4.011s      47.123us       0.000us         0.00%        1.195s      14.043us           0 B           0 B     365.46 GB      -2.62 MB         85120            --  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us        1.122s         1.83%        1.122s       5.150us           0 B           0 B           0 B           0 B        217813            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     905.876ms         1.47%     905.876ms      10.268us           0 B           0 B           0 B           0 B         88226            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 184.704s
Self CUDA time total: 61.451s


Top 20 operations by CPU time:
----------------------------------------
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total GFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                        model_inference        43.23%       79.842s        99.74%      184.220s      184.220s       0.000us         0.00%       61.496s       61.496s           0 B     -35.90 GB      15.53 MB    -146.85 GB             1            --  
                                               aten::to         0.47%     863.315ms        20.38%       37.638s      75.034us       0.000us         0.00%       23.865s      47.576us      35.90 GB           0 B     173.44 GB      -6.79 MB        501614            --  
                                         aten::_to_copy         1.28%        2.366s        19.91%       36.774s      91.721us       0.000us         0.00%       23.865s      59.522us      35.90 GB           0 B     173.44 GB      -1.43 MB        400938            --  
                                            aten::copy_         1.73%        3.188s        18.15%       33.515s      67.856us       25.093s        40.83%       25.094s      50.806us           0 B           0 B           0 B           0 B        493906            --  
                                        cudaMemcpyAsync        12.60%       23.266s        12.60%       23.272s     439.505us       0.000us         0.00%       3.681us       0.000us           0 B           0 B           0 B           0 B         52950            --  
                     aten::scaled_dot_product_attention         0.21%     380.196ms        12.52%       23.122s     542.884us       0.000us         0.00%        5.028s     118.042us           0 B           0 B       1.18 GB      -6.51 GB         42592            --  
               aten::_scaled_dot_product_attention_math         0.84%        1.546s        12.31%       22.736s     533.819us       0.000us         0.00%        5.027s     118.019us           0 B      -1.00 KB       7.51 GB    -702.08 GB         42592            --  
                                           aten::matmul         2.35%        4.344s        10.80%       19.948s      51.628us       0.000us         0.00%       30.480s      78.889us           0 B           0 B      27.76 GB      -1.64 GB        386370            --  
                                       cudaLaunchKernel         9.07%       16.750s        10.24%       18.909s       7.621us     146.785us         0.00%       2.324ms       0.001us           0 B           0 B           0 B           0 B       2481171            --  
                                           aten::linear         0.58%        1.067s         9.49%       17.535s      58.515us       0.000us         0.00%       29.258s      97.636us           0 B           0 B      12.99 GB           0 B        299665            --  
                                               aten::mm         3.73%        6.888s         5.10%        9.415s      31.417us       29.216s        47.54%       29.258s      97.636us           0 B           0 B      12.99 GB      12.99 GB        299665     63933.264  
                                              aten::mul         3.00%        5.545s         4.50%        8.316s      17.392us        1.954s         3.18%        1.954s       4.086us       1.04 KB       1.04 KB     195.40 GB     195.40 GB        478185        53.900  
                                  cudaStreamSynchronize         2.85%        5.264s         2.85%        5.264s     116.074us       0.000us         0.00%       0.000us       0.000us           0 B           0 B           0 B           0 B         45346            --  
                                              aten::add         1.46%        2.699s         2.72%        5.018s      19.291us     480.034ms         0.78%     480.068ms       1.846us           0 B           0 B       3.93 GB       3.93 GB        260113         2.060  
                                    aten::_safe_softmax         0.30%     546.141ms         2.19%        4.044s      94.939us       0.000us         0.00%     816.622ms      19.173us           0 B           0 B      12.41 GB      -3.15 GB         42592            --  
                                aten::repeat_interleave         0.34%     619.489ms         2.17%        4.011s      47.123us       0.000us         0.00%        1.195s      14.043us           0 B           0 B     365.46 GB      -2.62 MB         85120            --  
                                              aten::cat         1.11%        2.059s         2.04%        3.768s      21.174us     810.481ms         1.32%     810.543ms       4.555us           0 B           0 B      62.28 GB      62.28 GB        177949            --  
                                              aten::bmm         1.20%        2.210s         1.51%        2.783s      32.092us        1.214s         1.98%        1.215s      14.008us           0 B           0 B      14.77 GB      14.77 GB         86705      1703.747  
                                        aten::transpose         1.00%        1.854s         1.39%        2.569s       4.991us       0.000us         0.00%       0.000us       0.000us           0 B           0 B           0 B           0 B        514697            --  
                                                aten::t         0.51%     949.477ms         1.27%        2.355s       7.844us       0.000us         0.00%       0.000us       0.000us           0 B           0 B           0 B           0 B        300216            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 184.704s
Self CUDA time total: 61.451s


Top 15 operations by memory usage:
----------------------------------------
